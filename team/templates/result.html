{% extends "layout.html" %}

{% block style %}
<style>
    .heart{
        color: white;
    }

    .heart.clicked {
        color: red;
    }
</style>
{% endblock %}

{% block title %}
    Result
{% endblock %}

{% block main %}
    <div class="container">
        <h3>Google</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>タイトル</th>
                    <th>URL</th>
                    <th>説明文</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for google in googles %}
                <tr>
                    <td>{{ google["title"] }}</td>
                    <td><a href="{{ google['url'] }}">URL</a></td>
                    <td>{{ google["snippet"] }}</td>
                    <td>
                        <input id="googleid" name="googleid" type="hidden" value="{{ google['id']}}">
                        <input id="liked" name="liked" type="hidden" value="false">
                        <input type="submit" class="heart" value="&hearts;">
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <h3>Instagram</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>mediaID</th>
                    <th>URL</th>
                    <th>説明文</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for instagram in instagrams %}
                <tr></tr>
                    <td>{{ instagram["media_id"] }}</td>
                    <td><a href="{{ instagram['url'] }}">URL</a></td>
                    <td>{{ instagram["caption"] }}</td>
                    <td>
                        <form action="/likeinstagram" method="post">
                            <input name="id" type="hidden" value="{{ instagram['id']}}">
                            <button type="submit" class="heart" value="&hearts;">
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <h3>YouTube</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>タイトル</th>
                    <th>URL</th>
                    <th>チャンネル名</th>
                    <th>チャンネルURL</th>
                    <th>説明文</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for youtube in youtubes %}
                <tr></tr>
                    <td>{{ youtube["videotitle"] }}</td>
                    <td><a href="{{ youtube['videourl'] }}">URL</a></td>
                    <td>{{ youtube["channeltitle"] }}</td>
                    <td><a href="{{ youtube['channelurl'] }}">URL</a></td>
                    <td>{{ youtube["caption"] }}</td>
                    <td>
                        <form action="/likeyoutube" method="post">
                            <input name="id" type="hidden" value="{{ youtube['id']}}">
                            <input type="submit" class="heart" value="&hearts;">
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <script>
        function sendData() {
        var heart = document.getElementById('heart');
        var liked = document.getElementById('liked').value;
        var id = document.getElementById('id').value;

        if (liked == 'false') {
            heart.style.color = 'red';
            fetch('/like', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: 'id=' + encodeURIComponent(id) + '&liked=true'
            })
            .then(response => {
            if (response.ok) {
                console.log('Data sent successfully');
                document.getElementById('liked').value = 'true';
            } else {
                throw new Error('Network response was not ok');
            }
            })
            .catch(error => {
            console.error('There was a problem with the fetch operation:', error);
            });
        } else {
            heart.style.color = 'white';
            fetch('/like', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: 'id=' + encodeURIComponent(id) + '&liked=false'
            })
            .then(response => {
            if (response.ok) {
                console.log('Data sent successfully');
                document.getElementById('liked').value = 'false';
            } else {
                throw new Error('Network response was not ok');
            }
            })
            .catch(error => {
            console.error('There was a problem with the fetch operation:', error);
            });
        }
        }
    </script>
{% endblock %}